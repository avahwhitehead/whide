(function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/Whide/",r(r.s="a361")})({"12c1":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.incrementPos=void 0;var n=r("7d9f");function o(e,t){var r,o;try{for(var a=n.__values(t),i=a.next();!i.done;i=a.next()){var u=i.value;"\n"===u?(e.row++,e.col=0):e.col++}}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}}t.incrementPos=o},"15ba":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=n(r("2423"));function a(e,t){return void 0===t&&(t=0),null===e?t:null===e.left?a(e.right,t+1):void 0}function i(e,t){var r={error:t};return null===e?r.value=e:r.children=[i(e.left),i(e.right)],r}function u(e,t){return{error:!!t,tree:i(e,t)}}function l(e,t){return{error:!!t,tree:{value:e,error:t}}}function s(e,t,r){return{tree:{error:r,children:[e.tree,t.tree]},error:e.error||t.error||!!r}}function p(e,t,r){if(null===e)return{children:[]};for(var n=T(e.left,t.type,r),o=p(e.right,t,r),a=[n.tree],i=0,u=o.children;i<u.length;i++){var l=u[i];a.push(l)}return{children:a,error:n.error||o.error}}function c(e){return null===e?l("false"):u(e,"Expected 'false'")}function _(e){return e&&null===e.left&&null===e.right?l("true"):u(e,"Expected 'true'")}function d(e){var t=c(e);return t.error?(t=_(e),t.error?u(e,"Expected 'true' or 'false'"):t):t}function f(e,t){var r=a(e);if(void 0===r){var n="Not a valid number";return void 0!==t&&(n+=", expected "+t),u(e,n)}return void 0!==t&&r!==t?l(r,"Expected "+t):l(r)}function h(e,t,r){switch(t){case"nil":return null===e?u(e):u(e,"Expected nil");case"any":return{tree:i(e)};case"int":return f(e);case"false":return c(e);case"true":return _(e);case"bool":case"boolean":return d(e)}var n=r.get(t);if(void 0===n)return u(e,"Unknown type '"+t+"'");var o=T(e,n,r);return o.tree.value=t,o}function v(e,t,r){for(var n,o=0,a=t.type;o<a.length;o++){var i=a[o];if(n="string"===typeof i?h(e,i,r):"number"===typeof i?f(e,i):T(e,i,r),!n.error)return n}return 1===t.type.length?n:u(e,"Node does not match any type of '"+t.type.join("', '")+"'")}function y(e,t,r){return null==e?u(e,"Expected a tree, got nil"):s(T(e.left,t.left,r),T(e.right,t.right,r))}function g(e,t,r){var n=p(e,t,r),o=n.children;return{error:n.error,tree:{children:o,value:"[]",list:!0}}}function T(e,t,r){var n=t.category;switch(n){case"choice":return v(e,t,r);case"list":return g(e,t,r);case"tree":return y(e,t,r);default:throw new o.default("Unknown branch type: '"+n+"'")}}function N(e,t,r){r=r||new Map;var n=T(e,t,r);return{tree:n.tree,error:!!n.error}}t.default=N},"1f26":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayProgram=t.displayPad=t.fromPad=t.toPad=t.MacroManager=t.ProgramManager=t.Interpreter=t.parseProgram=t.linter=void 0;var n=r("7d9f"),o=n.__importStar(r("7c59"));t.linter=o.default,Object.defineProperty(t,"parseProgram",{enumerable:!0,get:function(){return o.parseProgram}});var a=n.__importDefault(r("e4e2"));t.Interpreter=a.default;var i=n.__importDefault(r("44c2"));t.ProgramManager=i.default;var u=n.__importDefault(r("be80"));t.MacroManager=u.default;var l=n.__importStar(r("6e61"));Object.defineProperty(t,"toPad",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"displayPad",{enumerable:!0,get:function(){return l.displayPad}}),Object.defineProperty(t,"fromPad",{enumerable:!0,get:function(){return l.fromPad}});var s=n.__importDefault(r("a115"));t.displayProgram=s.default},2423:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t}(Error);t.default=o},"244d":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringBuilder=void 0;var n=r("7d9f"),o=function(){function e(e){void 0===e&&(e={}),this._level=0,this._lines=[[0,""]],this._props={indent:void 0!==e.indent?e.indent:"    ",linebreak:void 0!==e.linebreak?e.linebreak:"\n"}}return e.prototype.indent=function(){return this._lines[this._lines.length-1][0]=++this._level,this},e.prototype.dedent=function(){return this._level>0&&this._level--,this._lines[this._lines.length-1][0]=this._level,this},e.prototype.push=function(e){return this._lines.push([this._level,e.toString()]),this},e.prototype.add=function(e){return this._lines[this._lines.length-1][1]+=e,this},e.prototype.break=function(){return this._lines.push([this._level,""]),this},e.prototype.toString=function(){var e=this;return this._lines.map((function(t){var r=n.__read(t,2),o=r[0],a=r[1];return e.props.indent.repeat(o)+a})).join(this.props.linebreak)},Object.defineProperty(e.prototype,"level",{get:function(){return this._level},set:function(e){this._level=e,this._lines[this._lines.length-1][0]=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"props",{get:function(){return this._props},set:function(e){this._props=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lines",{get:function(){return this._lines},enumerable:!1,configurable:!0}),e}();t.StringBuilder=o},"34d7":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7d9f"),o=r("12c1"),a=r("bbe5"),i=r("3fd8"),u=r("f0ec"),l=[i.TKN_SEP,i.TKN_ASSGN,i.TKN_BLOCK_OPN,i.TKN_BLOCK_CLS,i.TKN_PREN_OPN,i.TKN_PREN_CLS],s=[i.TKN_READ,i.TKN_WRITE,i.TKN_IF,i.TKN_ELSE,i.TKN_WHILE],p=[i.TKN_CONS,i.TKN_HD,i.TKN_TL],c=n.__spreadArray(n.__spreadArray([],n.__read(l)),[u.TKN_EQL,u.TKN_COMMA,u.TKN_DOT,u.TKN_COLON,u.TKN_MCRO_OPN,u.TKN_MCRO_CLS,u.TKN_LIST_OPN,u.TKN_LIST_CLS]),_=n.__spreadArray(n.__spreadArray([],n.__read(s)),[u.TKN_SWITCH,u.TKN_CASE,u.TKN_DEFAULT]),d=n.__spreadArray(n.__spreadArray([],n.__read(p)),[u.TKN_TRUE,u.TKN_FALSE]);function f(e){var t=/^[a-z_]\w*/i.exec(e);return null===t?null:t[0]}function h(e){var t=/^(\d+)[^\w]*/.exec(e);return null===t?null:t[1]}function v(e){var t=e.match(/^(@[:=a-z]+)/i);return null===t?null:t[0]}function y(e,t,r){var a,i,y,g,T,N;void 0===r&&(r=!1);try{for(var m=n.__values(r?l:c),O=m.next();!O.done;O=m.next()){var b=O.value;if(e.substr(0,b.length)===b){var K=n.__assign({},t);return o.incrementPos(K,b),{type:"symbol",value:b,pos:t,endPos:K,length:b.length}}}}catch(A){a={error:A}}finally{try{O&&!O.done&&(i=m.return)&&i.call(m)}finally{if(a)throw a.error}}var E=f(e);if(null===E)return r?null:(E=v(e),null!==E?{type:"number",token:E,value:u.PAD_VALUES[E],length:E.length,pos:t,endPos:{row:t.row,col:t.col+E.length}}:(E=h(e),null===E?null:{type:"number",token:E,value:Number.parseInt(E),length:E.length,pos:t,endPos:{row:t.row,col:t.col+E.length}}));try{for(var x=n.__values(r?s:_),P=x.next();!P.done;P=x.next()){var S=P.value;if(E===S){K=n.__assign({},t);return o.incrementPos(K,S),{type:"expression",value:S,length:S.length,pos:t,endPos:K}}}}catch(k){y={error:k}}finally{try{P&&!P.done&&(g=x.return)&&g.call(x)}finally{if(y)throw y.error}}try{for(var w=n.__values(r?p:d),L=w.next();!L.done;L=w.next()){S=L.value;if(E===S){K=n.__assign({},t);return o.incrementPos(K,S),{type:"operation",value:S,length:S.length,pos:t,endPos:K}}}}catch(I){T={error:I}}finally{try{L&&!L.done&&(N=w.return)&&N.call(w)}finally{if(T)throw T.error}}return{type:"identifier",value:E,length:E.length,pos:t,endPos:{row:t.row,col:t.col+E.length}}}function g(e,t){var r=new a.ErrorManager;t=t||{};var i={pureOny:t.pureOnly||!1},u={row:0,col:0},l=[];while(e.length){var s=e.match(/^\s+/);if(null===s)if("//"!==e.substr(0,2))if("(*"!=e.substr(0,2)){var p=y(e,n.__assign({},u),i.pureOny);if(null===p){var c=e.charAt(0);p={type:"unknown",value:c,pos:n.__assign({},u),endPos:{row:u.row,col:u.col+c.length},length:c.length},r.addError(u,'Unknown token "'+c+'"',p.endPos)}l.push(p),"number"===p.type?u.col+=p.length:o.incrementPos(u,p.value),e=e.substring(p.length)}else{_=e.search(/\*\)/)||-1;_=-1===_?e.length:_+2,o.incrementPos(u,e.substring(0,_)),e=e.substring(_)}else{var _=e.search("\n")||-1;-1===_?_=e.length:_+=1,u.row++,u.col=0,e=e.substring(_)}else{var d=s[0];o.incrementPos(u,d),e=e.substring(d.length)}}return[l,r.errors]}t.default=g},"3fd8":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TKN_TL=t.TKN_HD=t.TKN_CONS=t.TKN_WRITE=t.TKN_READ=t.TKN_WHILE=t.TKN_ELSE=t.TKN_IF=t.TKN_PREN_CLS=t.TKN_PREN_OPN=t.TKN_BLOCK_CLS=t.TKN_BLOCK_OPN=t.TKN_ASSGN=t.TKN_SEP=void 0,t.TKN_SEP=";",t.TKN_ASSGN=":=",t.TKN_BLOCK_OPN="{",t.TKN_BLOCK_CLS="}",t.TKN_PREN_OPN="(",t.TKN_PREN_CLS=")",t.TKN_IF="if",t.TKN_ELSE="else",t.TKN_WHILE="while",t.TKN_READ="read",t.TKN_WRITE="write",t.TKN_CONS="cons",t.TKN_HD="hd",t.TKN_TL="tl"},"44c2":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7d9f"),o=n.__importDefault(r("a383")),a=n.__importDefault(r("9a8e")),i=n.__importDefault(r("e4a2")),u=n.__importDefault(r("a115")),l=n.__importStar(r("6e61"));function s(e,t){for(var r=t.length-1;r>=0;--r)e.push(t[r])}var p=function(){function e(e,t){this._props=t||{},this._prog=e,this._variableManager=new o.default,this._variablePositions=new Map,this._macros=new Map,this._macroPositions=new Map,this.reanalyse()}return e.fromPad=function(t,r){return new e(l.fromPad(t),r)},Object.defineProperty(e.prototype,"variableManager",{get:function(){return this._variableManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"variables",{get:function(){return this.variableManager.variables},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"macros",{get:function(){return Array.from(this._macros.keys())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"macroCounts",{get:function(){return new Map(this._macros.entries())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"prog",{get:function(){return this._prog},enumerable:!1,configurable:!0}),e.prototype.setProg=function(e){this._prog=e,this.reanalyse()},e.prototype.reanalyse=function(){this._variableManager=new o.default,this._macros=new Map,this._macroPositions=new Map,this._variablePositions=new Map,this._analyseProgram()},e.prototype.replaceMacro=function(t,r,o){var a,i,u;void 0===o&&(o=!1);var l=this.variableManager.namespaceExists(t.name.value)?this.variableManager.getNewNamespace():t.name.value,s=this._macroPositions.get(r||t.name.value);if(s){var p=s[0],c=p.expr,_=new e(t);o&&_.toPure();try{for(var d=n.__values(_.variables),f=d.next();!f.done;f=d.next()){var h=f.value,v=this.variableManager.add(h,l);_.renameVariable(h,v)}}catch(T){a={error:T}}finally{try{f&&!f.done&&(i=d.return)&&i.call(d)}finally{if(a)throw a.error}}var y={type:"assign",complete:!0,ident:{type:"identName",value:t.input.value},arg:c.input},g=p.parent_body.indexOf(p.parent_cmd);(u=p.parent_body).splice.apply(u,n.__spreadArray([g,0,y],n.__read(t.body))),delete c.program,delete c.input,delete c.complete,c.type="identName",c.value=t.output.value,this.reanalyse()}},e.prototype.renameVariable=function(e,t){var r=this._variablePositions.get(e);if(void 0!==r){r.forEach((function(e){return e.value=t})),this.variableManager.delete(e),this.variableManager.add(t),this._variablePositions.delete(e);var o=this._variablePositions.get(t)||[];o.push.apply(o,n.__spreadArray([],n.__read(r))),this._variablePositions.set(t,o)}},e.prototype.displayProgram=function(e){return void 0===e&&(e="\t"),u.default(this.prog,e)},e.prototype._analyseProgram=function(){var e,t;this._analyseExpr(this._prog.input,this._prog,this._prog.body);try{for(var r=n.__values(this._prog.body),o=r.next();!o.done;o=r.next()){var a=o.value;this._analyseCmd(a,this._prog.body)}}catch(i){e={error:i}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return this._analyseExpr(this._prog.output,this._prog,this._prog.body),this},e.prototype._analyseCmd=function(e,t){var r,o,a=[e];while(a.length>0){var i=a.pop();switch(i.type){case"assign":this._analyseExpr(i.ident,i,t),this._analyseExpr(i.arg,i,t);break;case"cond":this._analyseExpr(i.condition,i,t),s(a,i.else),s(a,i.if);break;case"loop":this._analyseExpr(i.condition,i,t),s(a,i.body);break;case"switch":this._analyseExpr(i.condition,i,t);try{for(var u=(r=void 0,n.__values(i.cases)),l=u.next();!l.done;l=u.next()){var p=l.value;this._analyseExpr(p.cond,i,t),s(a,p.body)}}catch(c){r={error:c}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}break}}},e.prototype._analyseExpr=function(e,t,r){var n=[e];while(n.length>0){var o=n.pop();switch(o.type){case"identName":if("nil"!==o.value){this._variableManager.add(o.value,void 0,o.value);var a=this._variablePositions.get(o.value);void 0===a&&this._variablePositions.set(o.value,a=[]),a.push(o)}break;case"operation":s(n,o.args);break;case"equal":n.push(o.arg2),n.push(o.arg1);break;case"list":s(n,o.elements);break;case"tree_expr":n.push(o.right),n.push(o.left);break;case"macro":this._macros.set(o.program,(this._macros.get(o.program)||0)+1);var i=this._macroPositions.get(o.program);void 0===i&&this._macroPositions.set(o.program,i=[]),i.push({expr:o,parent_body:r,parent_cmd:t}),n.push(o.input);break;case"tree":break}}},e.prototype.toPure=function(e){var t,r,o,u=new a.default;do{o=u.next()}while(this.macroCounts.has(o));try{for(var l=n.__values(e||[]),s=l.next();!s.done;s=l.next()){var p=s.value,c=void 0,_=void 0;if(p.p){var d=p;c=d.n||d.p.name.value,_=d.p}else _=p,c=p.name.value;while(this.macros.includes(c))this.replaceMacro(_,c,!0)}}catch(f){t={error:f}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}this._bodyToPure(this._prog.body,o),this.reanalyse();while(this.macroCounts.has(o))this.replaceMacro(i.default,o);return this},e.prototype._bodyToPure=function(e,t){var r,o;try{for(var a=n.__values(e),i=a.next();!i.done;i=a.next()){var u=i.value;this._cmdToPure(u,t)}}catch(l){r={error:l}}finally{try{i&&!i.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return e},e.prototype._cmdToPure=function(e,t){var r=this;switch(e.type){case"assign":e.arg=this._exprToPure(e.arg,t);break;case"cond":e.condition=this._exprToPure(e.condition,t),e.if=e.if.map((function(e){return r._cmdToPure(e,t)})),e.else=e.else.map((function(e){return r._cmdToPure(e,t)}));break;case"loop":e.condition=this._exprToPure(e.condition,t),e.body=e.body.map((function(e){return r._cmdToPure(e,t)}));break;case"switch":this._switchToPure(e,t);break}return e},e.prototype._switchToPure=function(e,t){var r=e.condition,n=e.cases,o=e.default,a=e;a.type="cond",a.else=[],delete a.cases,delete a.default,delete a.condition,0===n.length?(a.condition={type:"tree",complete:!0,tree:null},a.if=[]):(a.condition=this._exprToPure({type:"equal",complete:!0,arg1:r,arg2:n[0].cond},t),a.if=this._bodyToPure(n[0].body,t));for(var i=a,u=1;u<n.length;u++){var l=n[u],s={type:"cond",complete:!0,condition:this._exprToPure({type:"equal",complete:!0,arg1:r,arg2:l.cond},t),if:this._bodyToPure(l.body,t),else:[]};i.else.push(s),i=s}return i.else=this._bodyToPure(o.body,t),a},e.prototype._listToPure=function(e,t){for(var r={type:"tree",complete:!0,tree:null},n=e.elements.length-1;n>=0;--n)r={type:"operation",complete:!0,op:{type:"opToken",value:"cons"},args:[this._exprToPure(e.elements[n],t),r]};return r},e.prototype._exprToPure=function(e,t){switch(e.type){case"identName":break;case"operation":for(var r=0;r<e.args.length;r++)e.args[r]=this._exprToPure(e.args[r],t);break;case"equal":return{type:"macro",complete:!0,program:t,input:{type:"operation",complete:!0,op:{type:"opToken",value:"cons"},args:[this._exprToPure(e.arg1,t),this._exprToPure(e.arg2,t)]}};case"list":return this._listToPure(e,t);case"tree_expr":return this._treeExprToPure(e,t);case"tree":return this._treeToPure(e.tree);case"macro":e.input=this._exprToPure(e.input,t);break}return e},e.prototype._treeExprToPure=function(e,t){return{type:"operation",complete:!0,op:{type:"opToken",value:"cons"},args:[this._exprToPure(e.left,t),this._exprToPure(e.right,t)]}},e.prototype._treeToPure=function(e){function t(){return{type:"tree",complete:!0,tree:null}}if(null===e)return t();var r=[],n=[];r.push(e);var o={type:"operation",complete:!0,op:{type:"opToken",value:"cons"},args:[]};function a(e,r,n,o){if(null!==e){var a={type:"operation",complete:!0,op:{type:"opToken",value:"cons"},args:[]};r.args.push(a),n.push(a),o.push(e)}else r.args.push(t())}n.push(o);while(n.length>0){var i=r.pop(),u=n.pop();0===u.args.length?(r.push(i),n.push(u),a(i.left,u,n,r)):1===u.args.length&&a(i.right,u,n,r)}return o},e.prototype.toPad=function(){return l.default(this.prog)},e}();t.default=p},"4ad8":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TKN_DO_CONS=t.TKN_CONS=t.TKN_DO_TL=t.TKN_TL=t.TKN_DO_HD=t.TKN_HD=t.TKN_QUOTE=t.TKN_VAR=t.TKN_DO_IF=t.TKN_IF=t.TKN_DO_WHILE=t.TKN_WHILE=t.TKN_DO_ASSIGN=t.TKN_ASSIGN_1=t.TKN_ASSIGN=t.TKN_TRUE=t.TKN_FALSE=t.TKN_NIL=void 0;var o=n(r("4b68"));t.TKN_NIL="nil",t.TKN_FALSE="false",t.TKN_TRUE="true",t.TKN_ASSIGN="@asgn",t.TKN_ASSIGN_1="@:=",t.TKN_DO_ASSIGN="@doAsgn",t.TKN_WHILE="@while",t.TKN_DO_WHILE="@doWhile",t.TKN_IF="@if",t.TKN_DO_IF="@doIf",t.TKN_VAR="@var",t.TKN_QUOTE="@quote",t.TKN_HD="@hd",t.TKN_DO_HD="@doHd",t.TKN_TL="@tl",t.TKN_DO_TL="@doTl",t.TKN_CONS="@cons",t.TKN_DO_CONS="@doCons";var a=[t.TKN_FALSE,t.TKN_TRUE,t.TKN_ASSIGN,t.TKN_ASSIGN_1,t.TKN_DO_ASSIGN,t.TKN_WHILE,t.TKN_DO_WHILE,t.TKN_IF,t.TKN_DO_IF,t.TKN_VAR,t.TKN_QUOTE,t.TKN_HD,t.TKN_DO_HD,t.TKN_TL,t.TKN_DO_TL,t.TKN_CONS,t.TKN_DO_CONS];function i(e){return o.default(e,a)}t.default=i},"4b68":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.TKN_PREN_CLS=t.TKN_PREN_OPN=t.TKN_LIST_CLS=t.TKN_LIST_OPN=t.TKN_TREE_CLS=t.TKN_TREE_OPN=t.TKN_CTR=t.TKN_COMMA=t.TKN_BAR=t.TKN_DOTS=t.TKN_DOT=void 0;var o=n(r("d46c"));t.TKN_DOT=".",t.TKN_DOTS="...",t.TKN_BAR="|",t.TKN_COMMA=",",t.TKN_CTR=":",t.TKN_TREE_OPN="<",t.TKN_TREE_CLS=">",t.TKN_LIST_OPN="[",t.TKN_LIST_CLS="]",t.TKN_PREN_OPN="(",t.TKN_PREN_CLS=")";var a=[t.TKN_DOTS,t.TKN_DOT,t.TKN_CTR,t.TKN_COMMA,t.TKN_BAR,t.TKN_TREE_OPN,t.TKN_TREE_CLS,t.TKN_LIST_OPN,t.TKN_LIST_CLS,t.TKN_PREN_OPN,t.TKN_PREN_CLS];function i(e,t){void 0===t&&(t=!0);var r=[],n=0;while(e.length){var o=e.length;if(e=e.trimStart(),n+=o-e.length,!e)break;var a=s(e);if(null===a){var i=p(e);if(null===i){var _=c(e);if(null==_)throw l(e.charAt(0),n);if(!u(_,t))throw l(_,n);r.push(_),n+=_.length,e=e.substr(_.length)}else r.push(i[0]),n+=i[1],e=e.substr(i[1])}else r.push(a),n+=a.length,e=e.substr(a.length)}return r}function u(e,t){return"nil"===e||!0===t||!1!==t&&t.includes(e)}function l(e,t){return new o.default("SyntaxError: Unexpected token '"+e+"' at position "+t)}function s(e){for(var t=0,r=a;t<r.length;t++){var n=r[t];if(e.substr(0,n.length)===n)return n}return null}function p(e){var t=/^\d+/.exec(e);return t?[Number.parseInt(t[0]),t[0].length]:null}function c(e){var t=/^[@a-z_'][a-z0-9_':=]*/i.exec(e);return t?t[0]:null}t.default=i},"5e3d":function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r("4b68"),a=r("7cc6"),i=n(r("848c"));function u(e){return e[0]===o.TKN_LIST_OPN&&(e.shift(),a._expect(e,o.TKN_LIST_CLS),!0)}function l(e,t){var r;return"string"===typeof t||"number"===typeof t?e.type.push(t):"choice"===t.category?(r=e.type).push.apply(r,t.type):e.type.push(t),e}function s(e){if(e[0]===o.TKN_DOTS)return e.shift(),a._expect(e,o.TKN_LIST_CLS),{category:"choice",type:["any"]};var t,r=c(e),n=a._expect(e,o.TKN_COMMA,o.TKN_LIST_CLS);return t=n===o.TKN_LIST_CLS?{category:"choice",type:["nil"]}:s(e),{category:"tree",left:r,right:t}}function p(e){var t,r=a._expect(e);switch(r){case o.TKN_BAR:case o.TKN_COMMA:case o.TKN_CTR:case o.TKN_DOT:case o.TKN_DOTS:case o.TKN_LIST_CLS:case o.TKN_PREN_CLS:case o.TKN_TREE_CLS:throw a._unexpectedToken(r);case o.TKN_TREE_OPN:t=d(e);break;case o.TKN_PREN_OPN:t=_(e);break;case o.TKN_LIST_OPN:t=f(e);break;default:t={category:"choice",type:[r]}}while(u(e))t={category:"list",type:t};return"choice"===t.category&&1===t.type.length?t.type[0]:t}function c(e){var t={category:"choice",type:[]};l(t,p(e));while(e[0]===o.TKN_BAR)e.shift(),l(t,p(e));if("choice"===t.category&&1===t.type.length){var r=t.type[0];if("string"!==typeof r&&"number"!==typeof r)return r}return t}function _(e){var t=c(e);return a._expect(e,o.TKN_PREN_CLS),t}function d(e){var t=c(e);a._expect(e,o.TKN_DOT);var r=c(e);return a._expect(e,o.TKN_TREE_CLS),{category:"tree",left:t,right:r}}function f(e){return e[0]===o.TKN_LIST_CLS?(e.shift(),{category:"choice",type:["nil"]}):s(e)}function h(e){0===e.length&&(e=["any"]);var t=c(e);if(e.length>0)throw new i.default("Unexpected token: '"+e[0]+"'");if("choice"===t.category&&1===t.type.length){var r=t.type[0];if("string"!==typeof r&&"number"!==typeof r)return r}return t}t.default=h},"6e61":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.displayPad=t.HWHILE_DISPLAY_FORMAT=t.PURE_DISPLAY_FORMAT=t.fromPad=void 0;var n=r("7d9f"),o=n.__importStar(r("a383")),a=r("244d");function i(e){var t,r,a=new o.VariableManager;a.add(e.input.value);var i=[];try{for(var l=n.__values(e.body),s=l.next();!s.done;s=l.next()){var p=s.value;i.push(u(p,a))}}catch(c){t={error:c}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}return[a.index(e.input.value),i,a.add(e.output.value)]}function u(e,t){switch(e.type){case"assign":return[":=",t.add(e.ident.value),l(e.arg,t)];case"cond":return["if",l(e.condition,t),e.if.map((function(e){return u(e,t)})),e.else.map((function(e){return u(e,t)}))];case"loop":return["while",l(e.condition,t),e.body.map((function(e){return u(e,t)}))];default:throw new Error("Unsupported feature '"+e.type+"'. Ensure the program is in pure WHILE.")}}function l(e,t){switch(e.type){case"identName":return["var",t.add(e.value)];case"operation":switch(e.op.value){case"cons":return["cons",l(e.args[0],t),l(e.args[1],t)];case"hd":case"tl":return[e.op.value,l(e.args[0],t)];case"true":case"false":default:throw new Error("Unsupported feature '"+e.type+"'. Ensure the program is in pure WHILE.")}case"tree":if(null===e.tree)return["quote","nil"];throw new Error("Unsupported feature '"+e.type+"'. Ensure the program is in pure WHILE.");case"equal":case"list":case"macro":case"tree_expr":throw new Error("Unsupported feature '"+e.type+"'. Ensure the program is in pure WHILE.")}}function s(e,t){var r,a;void 0===t&&(t="prog");var i=new o.default;i.addAnonymous(e[0]);var u=[];try{for(var l=n.__values(e[1]),s=l.next();!s.done;s=l.next()){var c=s.value;u.push(p(c,i))}}catch(_){r={error:_}}finally{try{s&&!s.done&&(a=l.return)&&a.call(l)}finally{if(r)throw r.error}}return{type:"program",complete:!0,name:{type:"identName",value:t},input:{type:"identName",value:i.addAnonymous(e[0])},output:{type:"identName",value:i.addAnonymous(e[2])},body:u}}function p(e,t){var r=[],o=[[e,[],r]];while(o.length>0){var a=n.__read(o.pop(),3),i=a[0],u=a[1],l=a[2];switch(i[0]){case":=":l.push({type:"assign",complete:!0,ident:{type:"identName",value:t.addAnonymous(i[1])},arg:c(i[2],t)});break;case"while":0===u.length&&u.push([]),1===u.length&&u[0].length===i[2].length?l.push({type:"loop",complete:!0,condition:c(i[1],t),body:u[0]}):(o.push([i,u,l]),o.push([i[2][u[0].length],[],u[0]]));break;case"if":0===u.length&&u.push([]),1===u.length&&u[0].length===i[2].length&&u.push([]),2===u.length&&u[0].length===i[2].length&&u[1].length===i[3].length?l.push({type:"cond",complete:!0,condition:c(i[1],t),if:u[0],else:u[1]}):(o.push([i,u,l]),1===u.length?o.push([i[2][u[0].length],[],u[0]]):2===u.length&&o.push([i[3][u[1].length],[],u[1]]));break}}return r[0]}function c(e,t){var r=[],o=[[e,[],r]];while(o.length>0){var a=n.__read(o.pop(),3),i=a[0],u=a[1],l=a[2];if("quote"===i[0]){if("nil"!==i[1])throw new Error('Unsupported quote "'+i[1]+'", expected "nil"');l.push({type:"tree",complete:!0,tree:null})}else"var"===i[0]?l.push({type:"identName",value:t.addAnonymous(i[1])}):0===u.length?(o.push([i,u,l]),o.push([i[1],[],u])):"cons"===i[0]&&1===u.length?(o.push([i,u,l]),o.push([i[2],[],u])):l.push({type:"operation",complete:!0,op:{type:"opToken",value:i[0]},args:u})}return r[0]}function _(e,t,r){void 0===r&&(r="    ");var n=new a.StringBuilder({indent:r}),o=[];return n.add("[").add(e[0]).add(", "),d(e[1],o,n),h(o,n,t),f(e[1],n),n.add(", ").add(e[2]).add("]"),n.break(),n.toString()}function d(e,t,r){if(r.add("["),e.length>0){r.break().indent(),t.push({data:e[e.length-1],level:0});for(var n=e.length-2;n>=0;n--)t.push({data:e[n],level:0,terminator:","})}}function f(e,t){e.length>0&&t.dedent(),t.add("]")}function h(e,t,r){while(e.length>0){var n=e.pop(),o=n.data;if(0===n.level&&t.add("["),n.level>=o.length)t.add("]"),n.terminator&&t.add(n.terminator),":="!==o[0]&&"if"!==o[0]&&"while"!==o[0]||t.break();else switch(o[0]){case":=":t.add(r.assign).add(", ").add(o[1]).add(", "),n.level=3,e.push(n),e.push({data:o[2],level:0});break;case"while":case"if":0===n.level?(t.add("while"===o[0]?r.while:r.if).add(", "),n.level=1,e.push(n),e.push({data:o[1],level:0})):1===n.level?(t.add(", "),n.level=2,e.push(n),d(o[2],e,t)):"if"===o[0]&&2===n.level?(f(o[2],t),t.add(", "),n.level=3,e.push(n),d(o[3],e,t)):(f(o[2],t),n.level=4,e.push(n));break;case"var":case"quote":t.add("var"===o[0]?r.var:r.quote).add(", ").add(o[1]),n.level=2,e.push(n);break;case"cons":0===n.level?(t.add(r.cons).add(", "),n.level=2,e.push(n),e.push({data:o[1],level:0})):(t.add(", "),n.level=3,e.push(n),e.push({data:o[2],level:0}));break;case"hd":case"tl":t.add("hd"===o[0]?r.hd:r.tl).add(", "),n.level=2,e.push(n),e.push({data:o[1],level:0});break;default:throw new Error('Unknown data type "'+o[0]+'"')}}}t.default=i,t.fromPad=s,t.PURE_DISPLAY_FORMAT={assign:":=",if:"if",while:"while",quote:"quote",var:"var",cons:"cons",hd:"hd",tl:"tl"},t.HWHILE_DISPLAY_FORMAT={assign:"@:=",if:"@if",while:"@while",quote:"@quote",var:"@var",cons:"@cons",hd:"@hd",tl:"@tl"},t.displayPad=_},"7c59":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseProgram=void 0;var n=r("7d9f"),o=n.__importDefault(r("34d7")),a=n.__importDefault(r("f5aa"));function i(e,t){var r=(null===t||void 0===t?void 0:t.lexOpts)||{},i=(null===t||void 0===t?void 0:t.parseOpts)||{};!0===(null===t||void 0===t?void 0:t.pureOnly)&&(r.pureOnly=!0,i.pureOnly=!0);var u=n.__read(o.default(e,r),2),l=u[0],s=u[1],p=n.__read(a.default(l,i),2),c=p[1];return n.__spreadArray(n.__spreadArray([],n.__read(s)),n.__read(c))}function u(e,t){var r=(null===t||void 0===t?void 0:t.lexOpts)||{},i=(null===t||void 0===t?void 0:t.parseOpts)||{};!0===(null===t||void 0===t?void 0:t.pureOnly)&&(r.pureOnly=!0,i.pureOnly=!0);var u=n.__read(o.default(e,r),2),l=u[0],s=u[1],p=n.__read(a.default(l,i),2),c=p[0],_=p[1];return[c,n.__spreadArray(n.__spreadArray([],n.__read(s)),n.__read(_))]}t.default=i,t.parseProgram=u},"7cc6":function(e,t,r){"use strict";var n=this&&this.__spreadArray||function(e,t){for(var r=0,n=t.length,o=e.length;r<n;r++,o++)e[o]=t[r];return e},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t._expect=t._unexpectedToken=void 0;var a=o(r("848c"));function i(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return 0===t.length?new a.default("Unexpected token: '"+e+"'"):1===t.length?new a.default("Unexpected token: expected '"+t[0]+"' got '"+e+"'"):new a.default("Unexpected token: expected one of '"+t.join("', '")+"' got '"+e+"'")}function u(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var o=e.shift();if(void 0===o)throw 0===t.length?new a.default("Unexpected end of input"):1===t.length?new a.default("Unexpected end of input: Expected '"+t[0]+"'"):new a.default("Unexpected end of input: Expected one of '"+t.join("', '")+"'");if(0===t.length)return o;if(t.includes(o))return o;throw i.apply(void 0,n([o],t))}t._unexpectedToken=i,t._expect=u},"7d9f":function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return a})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return l})),r.d(t,"__metadata",(function(){return s})),r.d(t,"__awaiter",(function(){return p})),r.d(t,"__generator",(function(){return c})),r.d(t,"__createBinding",(function(){return _})),r.d(t,"__exportStar",(function(){return d})),r.d(t,"__values",(function(){return f})),r.d(t,"__read",(function(){return h})),r.d(t,"__spread",(function(){return v})),r.d(t,"__spreadArrays",(function(){return y})),r.d(t,"__spreadArray",(function(){return g})),r.d(t,"__await",(function(){return T})),r.d(t,"__asyncGenerator",(function(){return N})),r.d(t,"__asyncDelegator",(function(){return m})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return b})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return x})),r.d(t,"__classPrivateFieldGet",(function(){return P})),r.d(t,"__classPrivateFieldSet",(function(){return S}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},n(e,t)};function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r],t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},a.apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function l(e,t){return function(r,n){t(r,n,e)}}function s(e,t){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(e,t)}function p(e,t,r,n){function o(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,a){function i(e){try{l(n.next(e))}catch(t){a(t)}}function u(e){try{l(n["throw"](e))}catch(t){a(t)}}function l(e){e.done?r(e.value):o(e.value).then(i,u)}l((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(e){return function(t){return l([e,t])}}function l(a){if(r)throw new TypeError("Generator is already executing.");while(i)try{if(r=1,n&&(o=2&a[0]?n["return"]:a[0]?n["throw"]||((o=n["return"])&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(o=i.trys,!(o=o.length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(u){a=[6,u],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}}var _=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function d(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||_(t,e,r)}function f(e){var t="function"===typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function h(e,t){var r="function"===typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{while((void 0===t||t-- >0)&&!(n=a.next()).done)i.push(n.value)}catch(u){o={error:u}}finally{try{n&&!n.done&&(r=a["return"])&&r.call(a)}finally{if(o)throw o.error}}return i}function v(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function g(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function T(e){return this instanceof T?(this.v=e,this):new T(e)}function N(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{l(o[e](t))}catch(r){c(a[0][3],r)}}function l(e){e.value instanceof T?Promise.resolve(e.value.v).then(s,p):c(a[0][2],e)}function s(e){u("next",e)}function p(e){u("throw",e)}function c(e,t){e(t),a.shift(),a.length&&u(a[0][0],a[0][1])}}function m(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:T(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e="function"===typeof f?f(e):e[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,a){t=e[r](t),o(n,a,t.done,t.value)}))}}function o(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)}}function b(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var K=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e["default"]=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&_(t,e,r);return K(t,e),t}function x(e){return e&&e.__esModule?e:{default:e}}function P(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"===typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function S(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"===typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}},"848c":function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t}(Error);t.default=o},"8a1c":function(e,t,r){"use strict";function n(e,t){void 0===t&&(t=".");for(var r="",n=0;n<e.length;n++)r+=a(e[n]),n<e.length-1&&(r+=t);return r}function o(e){return void 0===e||null===e?"nil":"number"===typeof e?""+e:"true"===e||"false"===e?e:'"'+e+'"'}function a(e){var t=e.children||[];return e.list?"["+n(t,",")+"]":t.length?"<"+n(t,".")+">":o(e.value)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a},"9a8e":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7d9f"),o=function(){function e(e){void 0===e&&(e=1),e<=0&&(e=1),this._nextName=[];for(var t=0;t<e;t++)this._nextName.push("A")}return e.prototype.next=function(e){void 0===e&&(e=!0);var t=this._nextName.join("");return e&&this._incrementName(),t},e.prototype._incrementName=function(){var e,t,r;function o(e){var t=e.charCodeAt(0)+1;return t>"Z".charCodeAt(0)?["A",!0]:[String.fromCharCode(t),!1]}var a=this._nextName.length-1;do{if(e=n.__read(o(this._nextName[a]),2),t=e[0],r=e[1],this._nextName[a]=t,0===a&&r){this._nextName.splice(0,0,"A");break}a--}while(r)},e}();t.default=o},a115:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7d9f"),o=r("244d");function a(e,t){void 0===t&&(t="\t");var r=new o.StringBuilder({indent:t});return r.add(e.name.value+" read "+e.input.value+" {").break(),0===e.body.length?r.break():i(e.body,r),r.add("} write "+e.output.value),r.toString()}function i(e,t){var r,o;t.indent();try{for(var a=n.__values(e.entries()),i=a.next();!i.done;i=a.next()){var l=n.__read(i.value,2),s=l[0],p=l[1];u(p,t),s<e.length-1&&t.add(";"),t.break()}}catch(c){r={error:c}}finally{try{i&&!i.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}t.dedent()}function u(e,t){var r,o;switch(e.type){case"assign":var a=l(e.arg);return t.add(e.ident.value),void(" "===a.charAt(0)?t.add(" :=").add(a):t.add(" := ").add(a));case"cond":return t.add("if ").add(l(e.condition)).add(" {").break(),i(e.if,t),e.else.length>0&&(t.add("} else {").break(),i(e.else,t)),void t.add("}");case"loop":return t.add("while ").add(l(e.condition)).add(" {").break(),i(e.body,t),void t.add("}");case"switch":t.add("switch ").add(l(e.condition)).add(" {").break(),t.indent();try{for(var u=n.__values(e.cases),s=u.next();!s.done;s=u.next()){var p=s.value;t.add("case ").add(l(p.cond)).add(":").break(),i(p.body,t)}}catch(c){r={error:c}}finally{try{s&&!s.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}return void t.push("}").dedent()}}function l(e,t){var r;switch(e.type){case"identName":r=e.value;break;case"operation":r=e.op.value+" "+e.args.map((function(t){return l(t,e.args.length>1)})).join(" ");break;case"equal":r=l(e.arg1)+" = "+e.arg2;break;case"list":r="["+e.elements.map((function(e){return l(e)})).join(", ")+"]";break;case"tree_expr":r="<"+l(e.left)+"."+l(e.right)+">";break;case"tree":r=s(e.tree);break;case"macro":r="<"+e.program+"> "+l(e.input);break}return!t||"identName"===e.type||"tree"===e.type&&null===e.tree?r:"("+r+")"}function s(e,t,r,o){if(void 0===t&&(t="cons "),void 0===r&&(r=" "),void 0===o&&(o=""),null===e)return"nil";var a="",i=[[e,!1]];while(i.length){var u=n.__read(i.pop(),2),l=u[0],s=u[1];null===l?(a+="nil",a+=s?o:r):(a+=t,i.push([l.right,!0]),i.push([l.left,!1]))}return a}t.default=a},a361:function(e,t,r){"use strict";r.r(t);var n=r("1f26"),o=r("c242");function a(e){self.postMessage(e)}function i(e){var t={type:"error",msg:e};a(t)}function u(e){var t={type:"end",res:e};a(t)}function l(){var e={type:"loaded"};a(e)}var s=void 0;self.addEventListener("message",(function(e){if("load"===e.data.op){var t=e.data,r=t.prog,a=t.macros,p=void 0;try{p=Object(o["treeParser"])(t.tree)}catch(_){return void i(_)}s=new n["Interpreter"](r,p,{macros:a}),l()}else if("run"===e.data.op)if(s){var c=s.run();u(c)}else i("No program loaded");else i("Unknown request operation: '"+e.data.op+"'")}))},a383:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariableManager=void 0;var n=r("7d9f"),o=n.__importDefault(r("9a8e")),a=function(){function e(e){this._variableMap=new Map,this._variableLookup=new Map,this._varNameGenerator=new o.default(null===e||void 0===e?void 0:e.minVarLen),this._namespaceGenerator=new o.default}return e.prototype.add=function(t,r,n,o){void 0===r&&(r=e.DEFAULT_NS),void 0===o&&(o=!1),r=r||e.DEFAULT_NS,void 0===n&&(n=this.getNextVarName());var a=this._variableMap.get(r);if(a||this._variableMap.set(r,a=new i),a.exists(t)){if(!o)return a.name(t);this._variableLookup.delete(a.name(t)),a.remove(t)}return a.add(t,n),this._variableLookup.set(n,[t,r]),n},e.prototype.addAnonymous=function(t,r){void 0===r&&(r=e.DEFAULT_NS),r=r||e.DEFAULT_NS;var n=this._variableMap.get(r);if(n||this._variableMap.set(r,n=new i),n.exists(t))return n.name(t);var o=this.getNextVarName();return this.add(o,r,o),o},e.prototype.get=function(t,r){return void 0===r&&(r=e.DEFAULT_NS),this.name(t,r)},e.prototype.name=function(t,r){var n;return void 0===r&&(r=e.DEFAULT_NS),null===(n=this._variableMap.get(r||e.DEFAULT_NS))||void 0===n?void 0:n.name(t)},e.prototype.index=function(t,r){var n;return void 0===r&&(r=e.DEFAULT_NS),null===(n=this._variableMap.get(r||e.DEFAULT_NS))||void 0===n?void 0:n.index(t)},e.prototype.delete=function(t,r){void 0===r&&(r=e.DEFAULT_NS);var n=this._variableMap.get(r||e.DEFAULT_NS);n&&(this._variableLookup.delete(n.name(t)),n.remove(t))},e.prototype.deleteNamespace=function(t){var r,o;void 0===t&&(t=e.DEFAULT_NS);var a=this._variableMap.get(t||e.DEFAULT_NS);try{for(var i=n.__values((null===a||void 0===a?void 0:a.variables)||[]),u=i.next();!u.done;u=i.next()){var l=u.value;a.remove(l[0])}}catch(s){r={error:s}}finally{try{u&&!u.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}this._variableMap.delete(t)},e.prototype.exists=function(t,r){return void 0===r&&(r=e.DEFAULT_NS),void 0!==this.name(t,r||e.DEFAULT_NS)},e.prototype.namespaceExists=function(e){return this._variableMap.has(e)},Object.defineProperty(e.prototype,"variables",{get:function(){return new Set(this._variableLookup.keys())},enumerable:!1,configurable:!0}),e.prototype.lookupVariable=function(e){return this._variableLookup.get(e)},Object.defineProperty(e.prototype,"namespaces",{get:function(){return this._variableMap.keys()},enumerable:!1,configurable:!0}),e.prototype.getNewNamespace=function(){var e;do{e=this._varNameGenerator.next()}while(this._variableLookup.has(e));return e},e.prototype.getNextVarName=function(){var e;do{e=this._varNameGenerator.next()}while(this._variableLookup.has(e));return e},e.DEFAULT_NS="default",e}();t.default=a;var i=function(){function e(){this._variables=[],this._names=[],this._ptr=0}return e.prototype.add=function(e,t,r){if(t=t||e,void 0!==r)return this._variables.splice(r,0,e),this._names.splice(r,0,t),r;if(!this.exists(e)){var n=this._ptr++;return this._variables.splice(n,0,e),this._names.splice(n,0,t),n}return this.index(e)},e.prototype.remove=function(e){var t;return t="number"===typeof e?e:this.index(e),t>-1&&(this._variables.splice(t,1),this._names.splice(t,1)),this},e.prototype.exists=function(e){return"number"===typeof e?void 0!==this._variables[e]:this.index(e)>-1},e.prototype.index=function(e){return this._variables.indexOf(e)},e.prototype.name=function(e){var t;return t="number"===typeof e?e:this._variables.indexOf(e),this._names[t]},Object.defineProperty(e.prototype,"variables",{get:function(){var e=this;return this._names.map((function(t,r){return[t,e._names[r]]}))},enumerable:!1,configurable:!0}),e}();t.VariableManager=i},a5d6:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=r("4b68"),a=r("4ad8"),i=r("7cc6"),u=n(r("848c"));function l(e){var t=null;while(e>0)e--,t={left:null,right:t};return t}function s(e){var t=c(e);i._expect(e,o.TKN_DOT);var r=c(e);return i._expect(e,o.TKN_TREE_CLS),{left:t,right:r}}function p(e){if(e[0]===o.TKN_LIST_CLS)return e.shift(),null;var t={left:c(e),right:null},r=t;while(i._expect(e,o.TKN_COMMA,o.TKN_LIST_CLS)===o.TKN_COMMA)r.right={left:c(e),right:null},r=r.right;return t}function c(e){var t=i._expect(e);if("number"===typeof t)return l(t);switch(t){case"nil":case a.TKN_FALSE:return l(0);case a.TKN_TRUE:return l(1);case o.TKN_TREE_OPN:return s(e);case o.TKN_LIST_OPN:return p(e);case a.TKN_ASSIGN:case a.TKN_ASSIGN_1:return l(2);case a.TKN_DO_ASSIGN:return l(3);case a.TKN_WHILE:return l(5);case a.TKN_DO_WHILE:return l(7);case a.TKN_IF:return l(11);case a.TKN_DO_IF:return l(13);case a.TKN_VAR:return l(17);case a.TKN_QUOTE:return l(19);case a.TKN_HD:return l(23);case a.TKN_DO_HD:return l(29);case a.TKN_TL:return l(31);case a.TKN_DO_TL:return l(37);case a.TKN_CONS:return l(41);case a.TKN_DO_CONS:return l(43);default:throw i._unexpectedToken(t)}}function _(e){if(0===e.length)return null;var t=c(e);if(e.length>0)throw new u.default("Unexpected token: Expected end of statement but got '"+e.shift()+"'");return t}t.default=_},bbe5:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ErrorManager=void 0;var n=r("7d9f"),o=function(){function e(){this._errors=[]}return Object.defineProperty(e.prototype,"errors",{get:function(){return this._errors},enumerable:!1,configurable:!0}),e.prototype.addError=function(e,t,r){return void 0===r?this._errors.push({message:t,position:n.__assign({},e)}):this._errors.push({message:t,position:n.__assign({},e),endPos:n.__assign({},r)}),this},e}();t.ErrorManager=o},be80:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7d9f"),o=n.__importDefault(r("44c2")),a=function(){function e(e,t){this._unregistered=new Set,this._macroMap=new Map,e&&this.register(e,t)}return e.prototype.register=function(e,t){var r,a;t||(t=e.name.value),this._macroMap.set(t,{n:t,p:e}),this._unregistered.delete(t);var i=new o.default(e);try{for(var u=n.__values(i.macros),l=u.next();!l.done;l=u.next()){var s=l.value;this._macroMap.has(s)||this._unregistered.add(s)}}catch(p){r={error:p}}finally{try{l&&!l.done&&(a=u.return)&&a.call(u)}finally{if(r)throw r.error}}},Object.defineProperty(e.prototype,"macroNames",{get:function(){return this._macroMap.keys()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"macros",{get:function(){return Array.from(this._macroMap.values())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"unregisteredMacros",{get:function(){return Array.from(this._unregistered)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasUnregistered",{get:function(){return this._unregistered.size>0},enumerable:!1,configurable:!0}),e.prototype.getNextUnregistered=function(){var e;while(1){if(0===this._unregistered.size)return null;if(this._iterator||(this._iterator=this._unregistered.values()),e=this._iterator.next(),e.done&&(this._iterator=void 0),!this._macroMap.has(e.value))return e.value}},e.prototype.autoRegister=function(e){while(this.hasUnregistered){var t=this.getNextUnregistered(),r=e(t);this.register(r,t)}},e}();t.default=a},c242:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.treeParser=t.stringify=void 0;var o=n(r("15ba")),a=n(r("4b68")),i=n(r("5e3d")),u=n(r("8a1c"));t.stringify=u.default;var l=n(r("4ad8")),s=n(r("a5d6"));function p(e){var t=a.default(e);return i.default(t)}function c(e){var t=l.default(e);return s.default(t)}function _(e,t,r){var n=p(t);r=r||new Map;var a=new Map;return r.forEach((function(e,t){var r=p(e);a.set(t,r)})),o.default(e,n,a)}t.treeParser=c,t.default=_},d46c:function(e,t,r){"use strict";var n=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!==typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t){return e.call(this,t)||this}return n(t,e),t}(Error);t.default=o},e4a2:function(e,t,r){"use strict";function n(e){return{type:"identName",value:e}}function o(e,t){return"string"===typeof t&&(t=n(t)),{type:"assign",complete:!0,ident:n(e),arg:t}}function a(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t=t.map((function(e){return"string"===typeof e?n(e):e})),{type:"operation",complete:!0,op:{type:"opToken",value:e},args:t}}function i(e,t){return{type:"loop",complete:!0,condition:e,body:t}}function u(e,t,r){return void 0===r&&(r=[]),{type:"cond",complete:!0,condition:e,if:t,else:r}}Object.defineProperty(t,"__esModule",{value:!0});var l=n("nil"),s=l,p={type:"operation",complete:!0,op:{type:"opToken",value:"cons"},args:[l,l]},c={type:"program",complete:!0,name:n("equals"),input:n("TS"),body:[o("s",a("cons","TS",l)),o("isEqual",p),i(n("s"),[o("t1",a("hd",a("hd","s"))),o("t2",a("tl",a("hd","s"))),o("s",a("tl","s")),u(n("t1"),[u(n("t2"),[o("s",a("cons",a("cons",a("tl","t1"),a("tl","t2")),"s")),o("s",a("cons",a("cons",a("hd","t1"),a("hd","t2")),"s"))],[o("isEqual",s),o("s",l)])],[u(n("t2"),[o("isEqual",s),o("s",l)])])])],output:n("isEqual")};t.default=c},e4e2:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("7d9f"),o=n.__importDefault(r("34d7")),a=n.__importDefault(r("f5aa")),i=function(){function e(e,t,r){var o,a;this._program=e,this._input=t,this._props=r||{},this._store=new Map,this._store.set(e.input.value,t),this._macros=new Map;try{for(var i=n.__values((null===r||void 0===r?void 0:r.macros)||[]),u=i.next();!u.done;u=i.next()){var l=u.value,s=void 0,p=void 0;l.p?(p=l.p,s=l.n||p.name.value):(s=l.name.value,p=l),this._macros.set(s,p)}}catch(c){o={error:c}}finally{try{u&&!u.done&&(a=i.return)&&a.call(i)}finally{if(o)throw o.error}}this._exprStack=[],this._commandStack=[{type:"block",body:n.__spreadArray([],n.__read(this._program.body))}]}return e.parse=function(t,r,i){var u=(null===i||void 0===i?void 0:i.lexOpts)||{},l=(null===i||void 0===i?void 0:i.parseOpts)||{};!0===(null===i||void 0===i?void 0:i.pureOnly)&&(u.pureOnly=!0,l.pureOnly=!0);var s=n.__read(o.default(t,null===i||void 0===i?void 0:i.lexOpts),2),p=s[0],c=s[1],_=n.__read(a.default(p,null===i||void 0===i?void 0:i.parseOpts),2),d=_[0],f=_[1],h=n.__spreadArray(n.__spreadArray([],n.__read(c)),n.__read(f));return d.complete?{success:!0,interpreter:new e(d,r,i)}:{success:!1,errors:h}},e.treeEquals=function(e,t){var r=[e],n=[t];while(r.length>0){var o=r.shift(),a=n.shift();if(null!==o||null!==a)if(null!==o&&null!==a)r.push(o.left,o.right),n.push(a.left,a.right);else if(o!==a)return!1}return!0},e.prototype.run=function(){return this._runCommandStack(),this._store.get(this._program.output.value)||null},Object.defineProperty(e.prototype,"store",{get:function(){return this._store},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ast",{get:function(){return this._program},enumerable:!1,configurable:!0}),e.prototype._evalExpr=function(t){var r=this._exprStack;r.push({type:"root",args:[t]}),r.push(e._copyExpr(t)),this._evalExprStack();var n=r.pop();return n.args[0].tree},e.prototype._runCommandStack=function(){var t,r;while(this._commandStack.length>0){var o=this._commandStack.pop();if("assign"===o.type){var a=this._evalExpr(o.arg);this._store.set(o.ident.value,a)}else if("cond"===o.type)null!==this._evalExpr(o.condition)?this._commandStack.push({type:"block",body:n.__spreadArray([],n.__read(o.if))}):this._commandStack.push({type:"block",body:n.__spreadArray([],n.__read(o.else))});else if("loop"===o.type)null!==this._evalExpr(o.condition)&&(this._commandStack.push(o),this._commandStack.push({type:"block",body:n.__spreadArray([],n.__read(o.body))}));else if("switch"===o.type){var i=this._evalExpr(o.condition),u=!1;try{for(var l=(t=void 0,n.__values(o.cases)),s=l.next();!s.done;s=l.next()){var p=s.value,c=this._evalExpr(p.cond);e.treeEquals(i,c)&&(u=!0,this._commandStack.push({type:"block",body:n.__spreadArray([],n.__read(p.body))}))}}catch(d){t={error:d}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}u||this._commandStack.push({type:"block",body:n.__spreadArray([],n.__read(o.default.body))})}else{if("block"!==o.type)throw new Error("Unexpected operation type '"+o.type+"'");var _=o.body.shift();o.body.length>0&&this._commandStack.push(o),void 0!==_&&this._commandStack.push(_)}}},e.prototype._evalExprStack=function(){var t,r,o,a;while(this._exprStack.length>1){var i=this._exprStack.pop();if("operation"===i.type){var u=!0;try{for(var l=(t=void 0,n.__values(i.args)),s=l.next();!s.done;s=l.next()){var p=s.value;if("literal"!==p.type){this._exprStack.push(i),this._exprStack.push(e._copyExpr(p)),u=!1;break}}}catch(v){t={error:v}}finally{try{s&&!s.done&&(r=l.return)&&r.call(l)}finally{if(t)throw t.error}}if(u){var c=void 0,_=i.args;switch(i.op.value){case"cons":c={left:_[0].tree,right:_[1].tree};break;case"hd":c=(null===(o=_[0].tree)||void 0===o?void 0:o.left)||null;break;case"tl":c=(null===(a=_[0].tree)||void 0===a?void 0:a.right)||null;break;default:throw new Error("Unknown operation token '"+i.type+"'")}this._replaceArgWithLiteral(c)}}else if("equal"===i.type)"literal"!==i.arg1.type?(this._exprStack.push(i),this._exprStack.push(e._copyExpr(i.arg1))):"literal"!==i.arg2.type?(this._exprStack.push(i),this._exprStack.push(e._copyExpr(i.arg2))):e.treeEquals(i.arg1.tree,i.arg2.tree)?this._replaceArgWithLiteral({left:null,right:null}):this._replaceArgWithLiteral(null);else if("tree_expr"===i.type)"literal"!==i.left.type?(this._exprStack.push(i),this._exprStack.push(e._copyExpr(i.left))):"literal"!==i.right.type?(this._exprStack.push(i),this._exprStack.push(e._copyExpr(i.right))):this._replaceArgWithLiteral({left:i.left.tree,right:i.right.tree});else if("identName"===i.type)this._replaceArgWithLiteral(this._store.get(i.value)||null);else if("tree"===i.type)this._replaceArgWithLiteral(i.tree);else if("list"===i.type){for(var d={type:"literal",tree:null},f=i.elements.length;f>=0;--f)d={type:"tree_expr",left:i.elements[f],right:d};"literal"===d.type?this._exprStack.push({type:"tree",tree:d.tree}):this._replaceArgWithLiteral(null)}else{if("macro"!==i.type)throw new Error("Unknown expression token '"+i.type+"'");if("literal"!==i.input.type)this._exprStack.push(i),this._exprStack.push(i.input);else{if(!this._macros.has(i.program))throw new Error('Could not find macro "'+i.program+'". Ensure the macro is named correctly and has been passed to the interpreter.');var h=new e(this._macros.get(i.program),i.input.tree,this._props);this._replaceArgWithLiteral(h.run())}}}},e._copyExpr=function(e){var t=n.__assign({},e);return"root"!==t.type&&"operation"!==t.type||(t.args=n.__spreadArray([],n.__read(t.args))),t},e.prototype._replaceArgWithLiteral=function(e){var t=this._exprStack.pop(),r={type:"literal",tree:e};if(void 0===t)throw new Error("Can't assign argument to undefined object");if("operation"===t.type||"root"===t.type){for(var n=0;n<t.args.length;n++)if("literal"!==t.args[n].type){t.args[n]=r;break}}else if("tree_expr"===t.type)"literal"!==t.left.type?t.left=r:t.right=r;else if("equal"===t.type)"literal"!==t.arg1.type?t.arg1=r:t.arg2=r;else{if("macro"!==t.type)throw new Error("Can't assign argument to type '"+t.type+"'");t.input=r}this._exprStack.push(t)},e}();t.default=i},f0ec:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAD_VALUES=t.TKN_PAD_DO_CONS=t.TKN_PAD_CONS=t.TKN_PAD_DO_TL=t.TKN_PAD_TL=t.TKN_PAD_DO_HD=t.TKN_PAD_HD=t.TKN_PAD_QUOTE=t.TKN_PAD_VAR=t.TKN_PAD_DO_IF=t.TKN_PAD_IF=t.TKN_PAD_DO_WHILE=t.TKN_PAD_WHILE=t.TKN_PAD_DO_ASSIGN=t.TKN_PAD_ASSIGN_1=t.TKN_PAD_ASSIGN=t.TKN_FALSE=t.TKN_TRUE=t.TKN_DEFAULT=t.TKN_CASE=t.TKN_SWITCH=t.TKN_COLON=t.TKN_DOT=t.TKN_COMMA=t.TKN_MCRO_CLS=t.TKN_MCRO_OPN=t.TKN_LIST_CLS=t.TKN_LIST_OPN=t.TKN_EQL=void 0,t.TKN_EQL="=",t.TKN_LIST_OPN="[",t.TKN_LIST_CLS="]",t.TKN_MCRO_OPN="<",t.TKN_MCRO_CLS=">",t.TKN_COMMA=",",t.TKN_DOT=".",t.TKN_COLON=":",t.TKN_SWITCH="switch",t.TKN_CASE="case",t.TKN_DEFAULT="default",t.TKN_TRUE="true",t.TKN_FALSE="false",t.TKN_PAD_ASSIGN="@asgn",t.TKN_PAD_ASSIGN_1="@:=",t.TKN_PAD_DO_ASSIGN="@doAsgn",t.TKN_PAD_WHILE="@while",t.TKN_PAD_DO_WHILE="@doWhile",t.TKN_PAD_IF="@if",t.TKN_PAD_DO_IF="@doIf",t.TKN_PAD_VAR="@var",t.TKN_PAD_QUOTE="@quote",t.TKN_PAD_HD="@hd",t.TKN_PAD_DO_HD="@doHd",t.TKN_PAD_TL="@tl",t.TKN_PAD_DO_TL="@doTl",t.TKN_PAD_CONS="@cons",t.TKN_PAD_DO_CONS="@doCons",t.PAD_VALUES={"@asgn":2,"@:=":2,"@doAsgn":3,"@while":5,"@doWhile":7,"@if":11,"@doIf":13,"@var":17,"@quote":19,"@hd":23,"@doHd":29,"@tl":31,"@doTl":37,"@cons":41,"@doCons":43}},f5aa:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r("7d9f"),a=r("3fd8"),i=r("bbe5"),u=r("f0ec"),l=r("4ad8");function s(e){return{type:"identName",value:e.value}}function p(e){return{type:"opToken",value:e.value}}(function(e){e[e["OK"]=0]="OK",e[e["ERROR"]=1]="ERROR",e[e["EOI"]=2]="EOI"})(n||(n={}));var c=function(e){function t(){return e.call(this)||this}return o.__extends(t,e),t.prototype.unexpectedToken=function(e,t,r){for(var n=[],a=3;a<arguments.length;a++)n[a-3]=arguments[a];return this.unexpectedValue.apply(this,o.__spreadArray([e,t,"token",r],o.__read(n)))},t.prototype.unexpectedEOI=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.unexpectedValue.apply(this,o.__spreadArray([e,t,"end of input",void 0],o.__read(r)))},t.prototype.unexpectedValue=function(e,t,r,n){void 0===r&&(r="token");for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];var i="Unexpected "+r;return 0===o.length?n&&(i+=': "'+n+'"'):(n&&(i+=' "'+n+'"'),1===o.length?i+=': Expected "'+o[0]+'"':i+=': Expected one of "'+o.join('", "')+'"'),this.addError(e,i,t)},t}(i.ErrorManager),_=function(){function e(e){this._errorManager=new c,this._tokens=e,this._lastToken=void 0,this._pos={col:0,row:0},this._endPos={col:0,row:0}}return Object.defineProperty(e.prototype,"errorManager",{get:function(){return this._errorManager},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"errors",{get:function(){return this.errorManager.errors},enumerable:!1,configurable:!0}),e.prototype.expect=function(){for(var e,t,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var i=this._next();if(null===i)return this.unexpectedEOI.apply(this,o.__spreadArray([],o.__read(r))),[n.EOI,null];if(0===r.length)return[n.OK,i];try{for(var u=o.__values(r),l=u.next();!l.done;l=u.next()){var s=l.value;if(i.value===s)return[n.OK,i]}}catch(p){e={error:p}}finally{try{l&&!l.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}return this.unexpectedToken.apply(this,o.__spreadArray([i.value],o.__read(r))),[n.ERROR,i]},e.prototype.next=function(){return this._next()},e.prototype.peek=function(e){return void 0===e&&(e=0),e<0||e>=this._tokens.length?null:this._tokens[e]},e.prototype.consumeUntil=function(){for(var e,t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a,i=[];while(null!==(a=this.peek())){try{for(var u=(e=void 0,o.__values(r)),l=u.next();!l.done;l=u.next()){var s=l.value;if(a.value===s)return i}}catch(p){e={error:p}}finally{try{l&&!l.done&&(t=u.return)&&t.call(u)}finally{if(e)throw e.error}}i.push(this.next())}return i},e.prototype.addError=function(e){return this._errorManager.addError(this._pos,e,this._endPos),this},e.prototype.unexpectedValue=function(e,t){for(var r,n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return"number"===typeof e&&(e=e.toString()),"number"===typeof t&&(t=t.toString()),(r=this._errorManager).unexpectedValue.apply(r,o.__spreadArray([this._pos,this._endPos,e,t],o.__read(n))),this},e.prototype.unexpectedToken=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return"number"===typeof e&&(e=e.toString()),(t=this._errorManager).unexpectedToken.apply(t,o.__spreadArray([this._pos,this._endPos,e],o.__read(r))),this},e.prototype.unexpectedEOI=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=this._errorManager).unexpectedEOI.apply(e,o.__spreadArray([this._pos,this._endPos],o.__read(t))),this},e.prototype.unexpectedEOICustom=function(e){this.errorManager.addError(this._pos,"Unexpected end of input: "+e,this._endPos)},e.prototype.unexpectedTokenCustom=function(e,t){"number"===typeof e&&(e=e.toString()),e?this.errorManager.addError(this._pos,'Unexpected token "'+e+'": '+t,this._endPos):this.errorManager.addError(this._pos,"Unexpected token: "+t,this._endPos)},e.prototype._next=function(){var e=this._tokens.shift()||null;return null!==e?(this._pos=o.__assign({},e.pos),this._endPos=o.__assign({},e.endPos),this._lastToken=e):this._pos=o.__assign({},this._endPos),e},e}();function d(e){for(var t=null;e>0;e--)t={left:null,right:t};return t}function f(e,t){return e!==u.TKN_TRUE&&(!!t.pureOnly||e!==u.TKN_FALSE&&e!==u.TKN_TRUE)}function h(e,t,r){var i;function c(e,t){var r=e.next();if(null===r)return[n.EOI,null];if(r.value===a.TKN_PREN_OPN){var i=n.OK,c=o.__read(h(e,t),2),_=c[0],f=c[1];_!==n.OK&&(i=_);var y=e.next();return null===y?(e.unexpectedEOI(a.TKN_PREN_CLS),i=n.OK):y.value===a.TKN_PREN_CLS||(e.unexpectedToken(y.value,a.TKN_PREN_CLS),i=n.ERROR),[i,f]}if("operation"===r.type){if(!t.pureOnly){if(r.value===u.TKN_FALSE)return[n.OK,{type:"tree",complete:!0,tree:d(0)}];if(r.value===u.TKN_TRUE)return[n.OK,{type:"tree",complete:!0,tree:d(1)}]}if(r.value===a.TKN_HD||r.value===a.TKN_TL){var T=o.__read(h(e,t,!1),2),N=T[0],m=T[1];return null===m?[N,{type:"operation",complete:!1,op:p(r),args:[m]}]:"identName"===m.type||m.complete?[N,{type:"operation",complete:!0,op:p(r),args:[m]}]:[N,{type:"operation",complete:!1,op:p(r),args:[m]}]}var O=o.__read(h(e,t,!1),2),b=O[0],K=O[1],E=o.__read(h(e,t,!1),2),x=E[0],P=E[1],S=n.OK;return b!==n.OK&&(S=b),x!==n.OK&&(S=x),!K||!P||"identName"!==K.type&&!K.complete||"identName"!==P.type&&!P.complete?[S,{type:"operation",complete:!1,op:p(r),args:[K,P]}]:[S,{type:"operation",complete:!0,op:p(r),args:[K,P]}]}if("identifier"===r.type)return r.value===l.TKN_NIL?[n.OK,{type:"tree",complete:!0,tree:d(0)}]:[n.OK,s(r)];if(!t.pureOnly){if("number"===r.type)return[n.OK,{type:"tree",complete:!0,tree:d(r.value)}];if(r.value===u.TKN_LIST_OPN){var w=o.__read(v(e,t),2),L=w[0],A=w[1];return L===n.OK?[L,{type:"list",complete:!0,elements:A}]:[L,{type:"list",complete:!1,elements:A}]}if(r.value===u.TKN_MCRO_OPN)return g(e,t)}return e.unexpectedTokenCustom(r.value,"Expected an expression or an identifier"),[n.ERROR,{type:"operation",complete:!1,op:null,args:[]}]}void 0===r&&(r=!0);var _=o.__read(c(e,t),2),f=_[0],y=_[1];if(r&&!t.pureOnly&&(null===(i=e.peek())||void 0===i?void 0:i.value)===u.TKN_EQL){e.next();var T=o.__read(h(e,t,r),2),N=T[0],m=T[1];return N===n.OK?[n.OK,{type:"equal",complete:!0,arg1:y,arg2:m}]:[N,{type:"equal",complete:!1,arg1:y,arg2:m}]}return[f,y]}function v(e,t){var r=e.peek();if(null===r)return e.next(),e.unexpectedEOI(u.TKN_LIST_CLS),[n.EOI,[]];if(r.value===u.TKN_LIST_CLS)return e.next(),[n.OK,[]];var a=[],i=n.OK;while(1){var l=o.__read(h(e,t),2),s=l[0],p=l[1];if(a.push(p),s===n.EOI){i=s;break}s===n.ERROR&&(e.consumeUntil(u.TKN_LIST_CLS,u.TKN_COMMA),i=n.ERROR);var c=e.peek();if(null===c){i=n.EOI,e.next(),e.unexpectedEOI(u.TKN_COMMA,u.TKN_LIST_CLS);break}if(c.value!==u.TKN_COMMA){if(c.value===u.TKN_LIST_CLS){e.next();break}e.consumeUntil(u.TKN_COMMA,u.TKN_LIST_CLS)}else e.next()}return[i,a]}function y(e,t){var r=n.OK,a=o.__read(h(e,t),2),i=a[0],l=a[1];if(i===n.EOI)return[n.EOI,{type:"tree_expr",complete:!1,left:l,right:null}];i!==n.OK&&(r=i);var s=o.__read(e.expect(u.TKN_DOT),1),p=s[0];if(p===n.EOI)return[n.EOI,{type:"tree_expr",complete:!1,left:l,right:null}];p!==n.OK&&(r=p);var c=o.__read(h(e,t),2),_=c[0],d=c[1];if(_===n.EOI)return[n.EOI,{type:"tree_expr",complete:!1,left:l,right:d}];_!==n.OK&&(r=_);var f=o.__read(e.expect(u.TKN_MCRO_CLS),1),v=f[0];return v!==n.OK&&(r=v),r===n.OK?[r,{type:"tree_expr",complete:!0,left:l,right:d}]:[r,{type:"tree_expr",complete:!1,left:l,right:d}]}function g(e,t){var r,a;if("identifier"===(null===(r=e.peek())||void 0===r?void 0:r.type)&&(null===(a=e.peek(1))||void 0===a?void 0:a.value)===u.TKN_MCRO_CLS){var i=n.OK,l=e.next().value,s=o.__read(e.expect(u.TKN_MCRO_CLS),1),p=s[0];if(p===n.EOI)return[n.EOI,{type:"macro",complete:!1,input:null,program:l}];p!==n.OK&&(i=p);var c=o.__read(h(e,t),2),_=c[0],d=c[1];return _===n.EOI?[n.EOI,{type:"macro",complete:!1,program:l,input:d}]:(_!==n.OK&&(i=_),i===n.OK?[i,{type:"macro",complete:!0,program:l,input:d}]:[i,{type:"macro",complete:!1,program:l,input:d}])}return y(e,t)}function T(e,t){var r=e.peek();return null===r?(e.unexpectedEOI(a.TKN_BLOCK_CLS),[n.EOI,[]]):r.value===a.TKN_ELSE?(e.next(),K(e,t)):[n.OK,[]]}function N(e,t){var r=[],i=n.OK;while(1){var u=o.__read(b(e,t),2),l=u[0],s=u[1];if(r.push(s),l===n.EOI){i=l;break}l===n.ERROR&&(e.consumeUntil(a.TKN_BLOCK_CLS,a.TKN_SEP),i=n.ERROR);var p=e.peek();if(null===p){i=n.EOI,e.next(),e.unexpectedEOI(a.TKN_SEP,a.TKN_BLOCK_CLS);break}if(p.value!==a.TKN_SEP)break;e.next()}return[i,r]}function m(e,t){function r(e){var r,l,s,p,c,_=o.__read(e.expect(u.TKN_COLON),1),d=_[0];if(d!==n.OK&&(i=d),d===n.EOI)i=n.EOI,c=[];else if((null===(l=e.peek())||void 0===l?void 0:l.value)===u.TKN_CASE||(null===(s=e.peek())||void 0===s?void 0:s.value)===u.TKN_DEFAULT||(null===(p=e.peek())||void 0===p?void 0:p.value)===a.TKN_BLOCK_CLS)i=n.ERROR,c=[],e.addError("Switch cases may not have empty bodies");else{var f=void 0;r=o.__read(N(e,t),2),f=r[0],c=r[1],f!==n.OK&&(i=f)}return[i,c]}var i,l=e.next();if(null===l)return[n.EOI,null];if(l.value===u.TKN_DEFAULT){i=n.OK;var s=o.__read(r(e),2),p=s[0],c=s[1];return p!==n.OK&&(i=p),i===n.OK?[i,{type:"switch_default",complete:!0,body:c}]:[i,{type:"switch_default",complete:!1,body:c}]}if(l.value===u.TKN_CASE){var _=o.__read(h(e,t),2),d=_[0],f=_[1];if(d===n.EOI)return[n.EOI,{type:"switch_case",complete:!1,body:[],cond:f}];i=d,(null===f||"identName"!==f.type&&"tree"!==f.type&&!f.complete)&&(i=n.ERROR);var v=o.__read(r(e),2);p=v[0],c=v[1];return p!==n.OK&&(i=p),i===n.OK?[i,{type:"switch_case",complete:!0,cond:f,body:c}]:[i,{type:"switch_case",complete:!1,cond:f,body:c}]}return e.unexpectedToken(l.value,u.TKN_CASE,u.TKN_DEFAULT),[n.ERROR,null]}function O(e,t){var r,i=n.OK,l=o.__read(h(e,t),2),s=l[0],p=l[1];if(s===n.EOI)return[n.EOI,null];s!==n.OK&&(i=s);var c,_=[],d=null,f=o.__read(e.expect(a.TKN_BLOCK_OPN),1),v=f[0];if(v===n.EOI)return[n.EOI,null];v!==n.OK&&(i=v);while(null!==(c=e.peek())){if(c.value!==u.TKN_DEFAULT&&c.value!==u.TKN_CASE)break;null!==d&&(i=n.ERROR,e.errorManager.addError(c.pos,"The 'default' case should be the last case in the block",c.endPos));var y=void 0,g=void 0;if(r=o.__read(m(e,t),2),y=r[0],g=r[1],y!==n.OK&&(i=y),i===n.EOI)break;null===g||"switch_case"===g.type?_.push(g):d=g}null===d&&(d={type:"switch_default",complete:!0,body:[]});var T=o.__read(e.expect(a.TKN_BLOCK_CLS),1),N=T[0];return N!==n.OK&&(i=N),i===n.OK?[i,{type:"switch",complete:!0,condition:p,cases:_,default:d}]:[i,{type:"switch",complete:!1,condition:p,cases:_,default:d}]}function b(e,t){var r=e.next();if(null===r)return[n.EOI,null];if(r.value===a.TKN_IF){var i=o.__read(h(e,t),2),l=i[0],p=i[1],c=o.__read(K(e,t),2),_=c[0],d=c[1],v=o.__read(T(e,t),2),y=v[0],g=v[1];return null===p||"identName"!==p.type&&"tree"!==p.type&&!p.complete||l!==n.OK||_!==n.OK||y!==n.OK?[n.ERROR,{type:"cond",complete:!1,condition:p,if:d,else:g}]:[n.OK,{type:"cond",complete:!0,condition:p,if:d,else:g}]}if(r.value===a.TKN_WHILE){var N=n.OK,m=o.__read(h(e,t),2);l=m[0],p=m[1];if(l!==n.OK&&(N=l),l===n.EOI)return[n.EOI,null];var b=o.__read(K(e,t),2),E=b[0],x=b[1];return E!==n.OK&&(N=E),N===n.OK?[n.OK,{type:"loop",complete:!0,condition:p,body:x}]:[N,{type:"loop",complete:!1,condition:p,body:x}]}if("identifier"===r.type){var P=n.OK,S=f(r.value,t);S||e.addError("Not a valid variable name");var w=o.__read(e.expect(a.TKN_ASSGN),1),L=w[0];if(L===n.EOI)return[n.EOI,null];L!==n.OK&&(P=L);var A=o.__read(h(e,t),2),k=A[0],I=A[1];return k===n.EOI?[n.EOI,null]:(k!==n.OK&&(P=k),S&&P===n.OK&&null!==I&&("identName"===I.type||I.complete)?[n.OK,{type:"assign",complete:!0,ident:s(r),arg:I}]:[n.ERROR,{type:"assign",complete:!1,ident:s(r),arg:I}])}return t.pureOnly||r.value!==u.TKN_SWITCH?(e.unexpectedTokenCustom(void 0,"Expected "+a.TKN_IF+" "+a.TKN_WHILE+" or an assignment statement"),[n.ERROR,null]):O(e,t)}function K(e,t){e.expect(a.TKN_BLOCK_OPN);var r=e.peek();if(null===r)return e.next(),e.unexpectedEOI(a.TKN_BLOCK_CLS),[n.EOI,[]];if(r.value===a.TKN_BLOCK_CLS)return e.next(),[n.OK,[]];var i=o.__read(N(e,t),2),u=i[0],l=i[1];if(u===n.EOI)return[u,l];var s=o.__read(e.expect(a.TKN_BLOCK_CLS),1),p=s[0];return p===n.EOI?[p,l]:u===n.OK&&p===n.OK?[n.OK,l]:[n.ERROR,l]}function E(e,t){function r(e,t){var r=e.peek();return null===r?(e.next(),e.unexpectedEOICustom("Missing input variable"),[n.EOI,null]):r.value===a.TKN_BLOCK_OPN?(e.errorManager.addError(r.pos,'Unexpected token "'+r.value+'": Missing input variable',r.endPos),[n.ERROR,null]):"identifier"===r.type?f(r.value,t)?(e.next(),[n.OK,s(r)]):(e.addError("Not a valid variable name"),e.next(),[n.ERROR,s(r)]):(e.next(),e.unexpectedValue("type",r.type,"identifier"),[n.ERROR,null])}function i(e,t){var o=e.peek();return null===o?(e.next(),e.unexpectedEOI(a.TKN_READ),[n.EOI,null]):o.value===a.TKN_READ?(e.next(),r(e,t)):o.value===a.TKN_BLOCK_OPN?(e.errorManager.unexpectedToken(o.pos,o.endPos,void 0,a.TKN_READ),[n.ERROR,null]):(e.next(),e.unexpectedToken(o.value,a.TKN_READ),[n.ERROR,"identifier"===o.type?s(o):null])}var u=e.peek();if(null===u)return e.next(),e.unexpectedEOICustom("Missing program name"),[n.EOI,null,null];if(u.value===a.TKN_READ){e.next(),e.errorManager.addError(u.pos,"Unexpected token: Missing program name",u.endPos);var l=o.__read(r(e,t),2),p=l[0],c=l[1];return p===n.OK?[n.OK,null,c]:[n.ERROR,null,c]}if(u.value===a.TKN_BLOCK_OPN)return e.errorManager.addError(u.pos,"Unexpected token: Missing program name",u.endPos),e.errorManager.unexpectedToken(u.pos,u.endPos,void 0,a.TKN_READ),[n.ERROR,null,null];e.next();var _=o.__read(i(e,t),2),d=(p=_[0],_[1]);return"identifier"!==u.type?(e.unexpectedValue("type",u.type,"identifier"),[n.ERROR,null,d]):p===n.OK?[n.OK,s(u),d]:[p,s(u),d]}function x(e,t){var r=n.OK,o=null,i=e.next();if(null===i)return e.unexpectedEOI(a.TKN_WRITE),[n.EOI,null];i.value===a.TKN_WRITE||("identifier"===i.type?(e.unexpectedToken(i.value,a.TKN_WRITE),r=n.ERROR,o=s(i)):(e.unexpectedValue(i.type,i.value,a.TKN_WRITE),r=n.ERROR));var u=e.next();return null===u?(e.unexpectedEOI("identifier"),r=n.EOI):"identifier"===u.type?o=s(u):(e.unexpectedTokenCustom(u.value," Expected an identifier"),r=n.ERROR),null===o||f(o.value,t)||e.addError("Not a valid variable name"),[r,o]}function P(e,t){var r,a,i=n.OK,u=n.OK,l=[],s=null,p=o.__read(E(e,t),3),c=p[0],_=p[1],d=p[2];if(c!==n.EOI&&(r=o.__read(K(e,t),2),i=r[0],l=r[1],i!==n.EOI)){a=o.__read(x(e,t),2),u=a[0],s=a[1];var f=e.next();null!==f&&e.unexpectedTokenCustom(f.value,"Expected end of input")}return _&&d&&s&&i===n.OK&&c===n.OK&&u===n.OK?{type:"program",complete:!0,input:d,output:s,name:_,body:l}:{type:"program",complete:!1,input:d,output:s,name:_,body:l}}function S(e,t){t=t||{};var r={pureOnly:t.pureOnly||!1},n=new _(e),o=P(n,r);return[o,n.errors]}t.default=S}});
//# sourceMappingURL=WhilejsWorker.949bb026.worker.js.map